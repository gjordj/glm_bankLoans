"0","###########################################################"
"0","# MATRIX CONFUSION AND ROC CURVE(AREA UNDER THE CURVE(AUC))############################################"
"0","###########################################################"
"0",""
"0","#TRAINING AND TESTING DATA"
"0","set.seed(1234)"
"0","n=nrow(df)"
"0","id_train <- sample(1:n , 0.90*n)"
"0","df.train = df[id_train,]"
"0","df.test = df[-id_train,]"
"0","nrow(df.train)"
"1","[1]"
"1"," 798640"
"1","
"
"0","ncol(df.train)"
"1","[1]"
"1"," 9"
"1","
"
"0","colnames(df.train)"
"1","[1]"
"1"," ""annual_inc""       "
"1"," ""employment_length"""
"1"," ""grade""            "
"1"," ""int_rate""         "
"1","
"
"1","[5]"
"1"," ""loan_amnt""        "
"1"," ""home_mortgage""    "
"1"," ""home_owner""       "
"1"," ""home_rent""        "
"1","
"
"1","[9]"
"1"," ""default""          "
"1","
"
"0","# LOGISTIC REGRESSION TRAIN MODEL"
"0","df.glm0<-glm(default~.,family=binomial,df.train); "
"2","glm.fit: fitted probabilities numerically 0 or 1 occurred"
"0","summary(df.glm0)"
"1","
Call:
"
"1",""
"1","glm(formula = default ~ ., family = binomial, data = df.train)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-0.1613  "
"1","-0.0588  "
"1","-0.0475  "
"1","-0.0379  "
"1"," 4.7117  "
"1","
"
"1","
Coefficients:
"
"1","                 "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)      "
"1"," -1.531e+01"
"1","  9.965e+01"
"1","  -0.154"
"1","  0.87789"
"1","    "
"1","
annual_inc       "
"1"," -1.957e-01"
"1","  6.092e-02"
"1","  -3.213"
"1","  0.00132"
"1"," ** "
"1","
employment_length"
"1","  3.076e-02"
"1","  3.093e-02"
"1","   0.995"
"1","  0.31996"
"1","    "
"1","
grade            "
"1"," -1.735e-01"
"1","  7.367e-02"
"1","  -2.355"
"1","  0.01851"
"1"," *  "
"1","
int_rate         "
"1","  7.833e-01"
"1","  9.846e-02"
"1","   7.955"
"1","  1.8e-15"
"1"," ***"
"1","
loan_amnt        "
"1","  4.930e-06"
"1","  4.180e-06"
"1","   1.179"
"1","  0.23823"
"1","    "
"1","
home_mortgage    "
"1","  8.798e+00"
"1","  9.965e+01"
"1","   0.088"
"1","  0.92964"
"1","    "
"1","
home_owner       "
"1","  8.879e+00"
"1","  9.965e+01"
"1","   0.089"
"1","  0.92899"
"1","    "
"1","
home_rent        "
"1","  9.128e+00"
"1","  9.965e+01"
"1","   0.092"
"1","  0.92701"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 16849  on 798639  degrees of freedom
"
"1",""
"1","Residual deviance: 16373  on 798631  degrees of freedom
"
"1","AIC: "
"1",""
"1","16391"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","14"
"1",""
"1","
"
"1","
"
"0","# # CROSS VALIDATION AND PREDICTION WITH LOGISTIC REGRESSION "
"0","# df.glm1<-glm(default~int_rate+annual_inc,family=binomial,df.train); "
"0","# AIC(df.glm0)"
"0","# AIC(df.glm1)"
"0","# BIC(df.glm0)"
"0","# BIC(df.glm1)"
