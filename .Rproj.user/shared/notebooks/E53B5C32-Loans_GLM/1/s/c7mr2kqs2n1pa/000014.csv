"0",""
"0","default_total <- sum(contingency_table[2,])"
"0",""
"0","# DEFAULT VS EMPLOYMENT_LENGTH#"
"0","###############################"
"0",""
"0","## two-way contingency table of categorical outcome and predictors"
"0","# ('n/a', '< 1 year', '1 year', '2 years', '3 years', '4 years', '5 years', '6 years', '7 years', '8 years', '9 years', '10+ years')"
"0",""
"0","contingency_table <- xtabs(~default+employment_length, data = df)"
"0","contingency_table"
"1","       employment_length
"
"1","default"
"1","      1"
"1","      2"
"1","      3"
"1","      4"
"1","      5"
"1","      6"
"1","      7"
"1","      8"
"1","      9"
"1","     10"
"1","     11"
"1","     12"
"1","
      0"
"1","  44754"
"1","  70513"
"1","  57000"
"1","  78784"
"1","  69922"
"1","  52463"
"1","  55627"
"1","  42887"
"1","  44524"
"1","  43882"
"1","  34608"
"1"," 291195"
"1","
      1"
"1","     71"
"1","     89"
"1","     95"
"1","     86"
"1","    104"
"1","     66"
"1","     77"
"1","     63"
"1","     71"
"1","     73"
"1","     49"
"1","    375"
"1","
"
"0","contingency_table_percentage <- c()"
"0",""
"0","employment_length <- 0"
"0","for( employment_length in 1:dim(contingency_table)[2]){"
"0","  contingency_table_percentage[employment_length] = contingency_table[2, employment_length]/contingency_table[1, employment_length]*100"
"0","}"
"0","# ('n/a', '< 1 year', '1 year', '2 years', '3 years', '4 years', '5 years', '6 years', '7 years', '8 years', '9 years', '10+ years')"
"0","contingency_table_percentage"
"1"," [1]"
"1"," 0.1586450"
"1"," 0.1262179"
"1"," 0.1666667"
"1"," 0.1091592"
"1"," 0.1487372"
"1"," 0.1258029"
"1"," 0.1384220"
"1"," 0.1468977"
"1","
"
"1"," [9]"
"1"," 0.1594646"
"1"," 0.1663552"
"1"," 0.1415858"
"1"," 0.1287797"
"1","
"
"0","barplot(contingency_table_percentage,"
"0","        main = ""Default % vs Employment Length"","
"0","        xlab = ""Employment Length"","
"0","        ylab = ""Default %"","
"0","        names.arg = c('n/a', '< 1 year', '1 year', '2 years', '3 years', '4 years', '5 years', '6 years', '7 years', '8 years', '9 years', '10+ years'),"
"0","        col = ""darkred"","
"0","        horiz = FALSE)"
